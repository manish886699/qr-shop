<!DOCTYPE html>
<html>
<head>
  <title>Order Page</title>
</head>
<body>

  <!-- Order form -->
  <input type="text" id="productNo" placeholder="Product No">
  <input type="text" id="productName" placeholder="Product Name">
  <input type="number" id="quantity" placeholder="Quantity">
  <input type="number" id="price" placeholder="Price">
  <input type="text" id="photo" placeholder="Photo URL">
  
  <button onclick="completeOrder()">Complete Order</button>

  <script>
    // Step 1: Google Sheet saving function
    function saveOrderToSheet(order) {
      fetch("https://script.google.com/macros/s/AKfycbzI-bQSA0jPMJN2ndeSpFsmVhJ5Z3O4oP8GTT4E_e0Bpc4cO5VZun33oZbll9PzplPrcQ/exec", {
        method: "POST",
        body: JSON.stringify(order)
      })
      .then(res => res.json())
      .then(data => {
        if (data.status === "success") {
          alert("Order saved to Google Sheet!");
        }
      })
      .catch(err => console.error(err));
    }

    // Step 2: Order complete hone par data collect karna
    function completeOrder() {
      let qty = parseInt(document.getElementById("quantity").value);
      let price = parseFloat(document.getElementById("price").value);
      let total = qty * price;

      let order = {
        productNo: document.getElementById("productNo").value,
        productName: document.getElementById("productName").value,
        quantity: qty,
        price: price,
        total: total,
        photo: document.getElementById("photo").value
      };

      saveOrderToSheet(order);
    }
  </script>

</body>
</html>
